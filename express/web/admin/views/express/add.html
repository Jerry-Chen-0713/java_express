<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="../../assets/css/layui.css">
    <link rel="stylesheet" href="../../assets/css/view.css"/>
    <title>快递录入系统</title>
</head>
<body class="layui-view-body">
<div class="layui-content">
    <div class="layui-row">
        <div class="layui-card">
            <div class="layui-card-header">录入快件</div>
            <form class="layui-form layui-card-body" id="expressForm">
                <div class="layui-form-item">
                    <label class="layui-form-label">单号</label>
                    <div class="layui-input-block">
                        <input type="text" name="number" required lay-verify="required" placeholder="请输入快递单号" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">快递公司</label>
                    <div class="layui-input-block">
                        <select name="company" lay-verify="required" lay-search>
                            <option value="">请选择快递公司</option>
                            <option value="顺丰速运">顺丰速运</option>
                            <option value="申通快递">申通快递</option>
                            <option value="圆通速递">圆通速递</option>
                            <option value="韵达快递">韵达快递</option>
                            <option value="中通快递">中通快递</option>
                            <option value="百世快递">百世快递</option>
                            <option value="京东快递">京东快递</option>
                            <option value="EMS">EMS</option>
                            <option value="德邦快递">德邦快递</option>
                            <option value="安能快递">安能快递</option>
                            <option value="安能物流">安能物流</option>
                            <option value="澳大利亚邮政">澳大利亚邮政</option>
                        </select>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">收件人姓名</label>
                    <div class="layui-input-block">
                        <input type="text" name="username" required lay-verify="required" placeholder="请输入收货人姓名" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">手机号码</label>
                    <div class="layui-input-block">
                        <input type="text" name="userPhone" required lay-verify="required|phone" placeholder="请输入手机号码" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <div class="layui-input-block">
                        <button class="layui-btn layui-btn-blue" lay-submit lay-filter="formDemo">立即提交</button>
                        <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="../../assets/layui.all.js"></script>
<script>
    layui.use(['form', 'layer'], function(){
        var form = layui.form;
        var layer = layui.layer;

        // 监听提交
        form.on('submit(formDemo)', function(data){
            var loading = layer.load(1, {
                shade: [0.1,'#fff']
            });

            // 发送AJAX请求
            fetch('/express/insert.do', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: new URLSearchParams(data.field)
            })
                .then(response => response.json())
                .then(result => {
                    layer.close(loading);

                    if(result.status === 0) {
                        layer.msg(result.result, {icon: 1});
                        // 清空表单
                        document.getElementById('expressForm').reset();
                        form.render();
                    } else {
                        layer.msg(result.result, {icon: 2});
                    }
                })
                .catch(error => {
                    layer.close(loading);
                    layer.msg('网络错误，请重试', {icon: 2});
                    console.error('Error:', error);
                });

            return false; // 阻止表单跳转
        });
    });
</script>
</body>
</html>