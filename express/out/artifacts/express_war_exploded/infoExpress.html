<!DOCTYPE html>
<html>
<head>
    <title>快递柜查询 -- 快件e栈服务平台</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
    <link href="css/normalize.css" type="text/css" rel="stylesheet" />
    <link href="css/common.css" type="text/css" rel="stylesheet" />
    <script src="js/jquery.min.js" type="text/javascript"></script>
    <script src="js/common.js" type="text/javascript"></script>
    <style type="text/css">
        body{
            margin: 0;
            padding: 0;
            background-color: #eeeeee;
            font-family: "楷体";
        }
        .content{
            padding: 20px;
        }
        .district-select {
            margin-bottom: 20px;
        }
        .district-select select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        .locker-stats {
            background: #fff;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .locker-stats h3 {
            margin: 0 0 10px 0;
            color: #333;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
        }
        .size-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        .size-item {
            flex: 1;
            text-align: center;
            padding: 10px;
            border-radius: 5px;
            margin: 0 5px;
        }
        .size-large {
            background: #e8f5e8;
            border: 1px solid #4caf50;
        }
        .size-medium {
            background: #e3f2fd;
            border: 1px solid #2196f3;
        }
        .size-small {
            background: #fff3e0;
            border: 1px solid #ff9800;
        }
        .size-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .size-count {
            font-size: 18px;
            font-weight: bold;
        }
        .available {
            color: #4caf50;
        }
        .used {
            color: #f44336;
        }
        .total {
            color: #666;
        }
        .no-data {
            text-align: center;
            padding: 40px;
            color: #999;
        }
    </style>
</head>
<body>
    <div class="content">
        <div class="headerNav">
            <div class="headerNavTop"><div class="headerNavIcon headerNavIconOut"><span></span><span></span></div></div>
            <div class="headerNavCont">
                <a href="index.html">快递首页</a>
                <a href="userhome.html">个人中心</a>
                <a href="delivery.html">送货上门</a>
                <a href="sendexpress.html">我要寄件</a>
                <a href="lazyboard.html">懒人排行</a>
                <a href="expassistant.html">快递助手</a>
            </div>
        </div>

        <div class="district-select">
            <select id="districtSelect">
                <option value="">请选择区域</option>
                <option value="黄浦区">黄浦区</option>
                <option value="徐汇区">徐汇区</option>
                <option value="长宁区">长宁区</option>
                <option value="静安区">静安区</option>
                <option value="普陀区">普陀区</option>
                <option value="虹口区">虹口区</option>
                <option value="杨浦区">杨浦区</option>
                <option value="闵行区">闵行区</option>
                <option value="宝山区">宝山区</option>
                <option value="嘉定区">嘉定区</option>
                <option value="浦东新区">浦东新区</option>
                <option value="金山区">金山区</option>
                <option value="松江区">松江区</option>
                <option value="青浦区">青浦区</option>
                <option value="奉贤区">奉贤区</option>
                <option value="崇明区">崇明区</option>
            </select>
        </div>

        <div id="lockerStats"></div>
    </div>

    <script type="text/javascript">
        $(document).ready(function() {
            // 区域选择变化时加载快递柜数据
            $('#districtSelect').on('change', function() {
                var district = $(this).val();
                if (district) {
                    loadLockerStats(district);
                } else {
                    $('#lockerStats').html('');
                }
            });

            // 加载快递柜统计数据
            function loadLockerStats(district) {
                $.ajax({
                    url: 'express/lockerStats.do',
                    type: 'POST',
                    data: {
                        district: district
                    },
                    dataType: 'json',
                    success: function(response) {
                        console.log('服务器响应:', response);

                        if (response.status === 0) {
                            displayLockerStats(response.data);
                        } else {
                            $('#lockerStats').html('<div class="no-data">' + response.result + '</div>');
                        }
                    },
                    error: function(xhr, status, error) {
                        console.error('请求错误:', error);
                        $('#lockerStats').html('<div class="no-data">网络错误，请检查网络连接后重试</div>');
                    }
                });
            }

            // 显示快递柜统计数据
            function displayLockerStats(stats) {
                var html = '';
                
                if (stats && stats.length > 0) {
                    html += '<div class="locker-stats">';
                    html += '<h3>' + $('#districtSelect').val() + ' - 快递柜使用情况</h3>';
                    
                    stats.forEach(function(item) {
                        var sizeClass = '';
                        var sizeName = '';
                        
                        switch(item.size) {
                            case '大':
                                sizeClass = 'size-large';
                                sizeName = '大号柜';
                                break;
                            case '中':
                                sizeClass = 'size-medium';
                                sizeName = '中号柜';
                                break;
                            case '小':
                                sizeClass = 'size-small';
                                sizeName = '小号柜';
                                break;
                        }
                        
                        html += '<div class="size-stats">';
                        html += '<div class="size-item ' + sizeClass + '">';
                        html += '<div class="size-title">' + sizeName + '</div>';
                        html += '<div class="size-count available">空闲: ' + item.available + '</div>';
                        html += '<div class="size-count used">占用: ' + item.used + '</div>';
                        html += '<div class="size-count total">总数: ' + item.total + '</div>';
                        html += '</div>';
                        html += '</div>';
                    });
                    
                    html += '</div>';
                } else {
                    html = '<div class="no-data">暂无数据</div>';
                }
                
                $('#lockerStats').html(html);
            }

            // 使用模拟数据（实际开发中应该调用后端API）
            $('#districtSelect').on('change', function() {
                var district = $(this).val();
                if (district) {
                    loadLockerStats(district);
                } else {
                    $('#lockerStats').html('');
                }
            });
        });
    </script>
</body>
</html>
