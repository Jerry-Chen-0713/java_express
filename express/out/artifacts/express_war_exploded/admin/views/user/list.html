<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>用户列表</title>
	<link rel="stylesheet" type="text/css" href="../../css/reset.css"/>
	<link rel="stylesheet" type="text/css" href="../../css/list.css"/>
	<!-- 使用更稳定的CDN链接 -->
	<link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.17.1/bootstrap-table.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="/js/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.17.1/bootstrap-table.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.17.1/locale/bootstrap-table-zh-CN.min.js"></script>
</head>
<body>
	<table id="user_list"></table>
	<script>
		$(function (){
			$("#user_list").bootstrapTable({
				url:"/user/list.do",//数据地址
				striped:true,//是否显示行间隔
				pageNumber:1,//初始化加载第几页
				pagination:true,//是否分页
				sidePagination:"server",
				pageSize:5,
				pageList:[5,10,20],
				showRefresh:true,
				queryParams:function (params){
					var temp = {
						offset:params.offset,
						pageNumber: params.limit
					}
					return temp;
				},
				columns:[
					{
						title:"编号",
						field:"id",
					},{
						title:"昵称",
						field:"userName",
					},{
						title:"手机号码",
						field:"userPhone",
					},{
						title:"密码",
						field:"password",
						formatter: function(value) {
							return "******";
						}
					},{
						title:"注册时间",
						field:"createTime",
						formatter: function(value) {
							if (value) {
								return new Date(value).toLocaleString();
							}
							return "";
						}
					},{
						title:"上次登陆时间",
						field:"loginTime",
						formatter: function(value) {
							if (value) {
								return new Date(value).toLocaleString();
							}
							return "";
						}
					},{
						title:"操作",
						field:"id",
						formatter: function(value) {
							return '<span class="btn-danger" onclick="deleteUser(' + value + ')">删除</span>';
						}
					}
				]
			});
		});

		function deleteUser(id) {
			if (confirm('确定要删除这个用户吗？')) {
				$.getJSON("/user/delete.do", {id: id}, function(data){
					if(data.status === 0) {
						alert('删除成功！');
						$("#user_list").bootstrapTable('refresh');
					} else {
						alert('删除失败：' + data.result);
					}
				});
			}
		}
	</script>
</body>
</html>
